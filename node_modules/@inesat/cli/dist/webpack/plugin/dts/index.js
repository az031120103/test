"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const dts_1 = __importDefault(require("./dts"));
const fast_glob_1 = __importDefault(require("fast-glob"));
const store_1 = __importDefault(require("../../../helper/store"));
//
const PLUGIN_NAME = 'DTSPlugin';
//
class DTSPlugin {
    constructor(options) {
        this.options = options;
    }
    apply(compiler) {
        const dts = new dts_1.default();
        const options = this.options;
        compiler.hooks.afterEmit.tap(PLUGIN_NAME, async () => {
            if (options) {
                dts.setup(options);
                const dtslist = await (0, fast_glob_1.default)([`${store_1.default.config.appSrc}/**/*.(ts|tsx)`]);
                dtslist.map(d => {
                    dts.emit(d);
                });
                dts.createFile();
            }
        });
    }
}
exports.default = DTSPlugin;
//# sourceMappingURL=index.js.map